import{Q as y,a as B}from"./QTable--4kp4avH.js";import{f as C,r as Q,aa as g,H as q,y as _,t as i,s as l,m as r,u as a,I as x,q as j,N,E as F,ab as p,Q as U}from"./index-biZAYMy_.js";import{Q as $}from"./QForm-B6zZp2Tf.js";import{u as z}from"./use-quasar-ThZkhwN7.js";import{_ as b}from"./ButtonWithTooltip.vue_vue_type_script_setup_true_lang-DXByFzTW.js";import{a as D,b as f}from"./utils-O6UG9Aye.js";import{a as n}from"./api-Drwuoc-q.js";import"./QList-TemXHNzd.js";import"./QChip-CiSapyxv.js";import"./QItem-NaHNb7v-.js";import"./QItemSection-gXIjE-rJ.js";import"./QItemLabel-Dpd1RpBi.js";import"./format-CJebrXOQ.js";import"./selection-DysZVcNr.js";import"./auth-JCbPQ19o.js";import"./pinia-Cz-fGEgD.js";import"./axios-Bf-I0BKU.js";import"./index-3fevySbJ.js";const T={class:"row q-ma-md"},E={class:"row q-ma-md items-center",flat:""},I={class:"row"},oe=C({__name:"BackupsComponent",setup(J){const c=z(),m=Q([]),t=g({name:"",database:!0,files:!0,jobs:!0}),k=[{label:"Timestamp",field:"timestamp",name:"timestamp"},{label:"Name",field:"name",name:"name"},{label:"Database",field:"database",name:"database"},{label:"Jobs",field:"jobs",name:"jobs"},{label:"Files",field:"files",name:"files"},{label:"Size",field:"size",name:"size"},{label:"Actions",field:"actions",name:"actions"}],u=async()=>{m.value=(await n.get("/admin/backup")).data},V=async()=>{const o=await n.post("/admin/backup/create",D(t));o.data!==void 0&&c.notify(`Created backup ${o.data}`),u()},v=async(o,e)=>{(e.ctrlKey||await f("delete backup",o.name))&&(m.value.splice(m.value.indexOf(o),1),n.post("/admin/backup/delete",{timestamp:o.timestamp}))},w=async(o,e)=>{(e.ctrlKey||await f("restore backup ",o.name))&&(await n.post("/admin/backup/restore",{timestamp:o.timestamp}),c.notify(`Restored backup ${o.name}`))};return q(u),(o,e)=>(j(),_(x,null,[e[5]||(e[5]=i("div",{class:"row q-ma-md text-h4"},"Backups",-1)),i("div",T,[l(y,{rows:a(m),columns:k,pagination:{rowsPerPage:10},"hide-bottom":a(m).length<=10},{"body-cell-actions":r(({row:s})=>[l(B,null,{default:r(()=>[l(b,{tooltip:"Restore",icon:"mdi-restore",color:"accent",onClick:d=>w(s,d)},null,8,["onClick"]),l(b,{tooltip:"Delete",icon:"mdi-delete",color:"negative",onClick:d=>v(s,d)},null,8,["onClick"])]),_:2},1024)]),_:1},8,["rows","hide-bottom"])]),l(N),i("div",E,[e[4]||(e[4]=i("div",{class:"text-h6 q-mr-md"},"New backup:",-1)),i("div",null,[l($,null,{default:r(()=>[i("div",I,[l(F,{"item-aligned":"",dense:"",class:"col",modelValue:a(t).name,"onUpdate:modelValue":e[0]||(e[0]=s=>a(t).name=s),required:"",label:"Name"},null,8,["modelValue"]),l(p,{class:"col",modelValue:a(t).database,"onUpdate:modelValue":e[1]||(e[1]=s=>a(t).database=s),dense:"",label:"Database"},null,8,["modelValue"]),l(p,{class:"col",modelValue:a(t).files,"onUpdate:modelValue":e[2]||(e[2]=s=>a(t).files=s),dense:"",label:"Files"},null,8,["modelValue"]),l(p,{class:"col",modelValue:a(t).jobs,"onUpdate:modelValue":e[3]||(e[3]=s=>a(t).jobs=s),dense:"",label:"Jobs"},null,8,["modelValue"]),l(U,{class:"col q-ma-md",disabled:!a(t).database&&!a(t).files&&!a(t).jobs||!a(t).name,color:"positive",label:"Create",onClick:V},null,8,["disabled"])])]),_:1})])])],64))}});export{oe as default};
